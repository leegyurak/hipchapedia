spring:
  application:
    name: hipchapedia

  lifecycle:
    timeout-per-shutdown-phase: 30s

  datasource:
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:hipchapedia}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
    username: ${DB_USER:root}
    password: ${DB_PASSWORD:password}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: ${SHOW_SQL:false}
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect
    open-in-view: false

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true
    out-of-order: false
    clean-disabled: false

  jackson:
    serialization:
      write-dates-as-timestamps: false
    time-zone: UTC

  mvc:
    async:
      request-timeout: 300000  # 5분 (밀리초)

redis:
  channel:
    request: ${REDIS_REQUEST_CHANNEL:lyrics:requests}
    result: ${REDIS_RESULT_CHANNEL:lyrics:results}

anthropic:
  api-key: ${ANTHROPIC_API_KEY}
  model: claude-haiku-4-5

server:
  port: ${PORT:8000}
  error:
    include-message: always
    include-stacktrace: on_param
  tomcat:
    connection-timeout: 300000  # 5분 (밀리초)
    keep-alive-timeout: 300000
  shutdown: graceful

logging:
  level:
    root: INFO
    com.hipchapedia: DEBUG
    org.hibernate.SQL: ${SQL_LOG_LEVEL:INFO}
    org.hibernate.type.descriptor.sql.BasicBinder: ${SQL_LOG_LEVEL:INFO}

# CORS 설정 (prod 프로파일에서 사용)
# 여러 origin을 허용하려면 쉼표로 구분
# 예: CORS_ALLOWED_ORIGINS=https://example.com,https://www.example.com
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:}
